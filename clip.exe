"use client";
import { useGSAP } from "@gsap/react";
import gsap from "gsap";
import ScrollTrigger from "gsap/ScrollTrigger"; // Import ScrollTrigger separately
import React, { useRef, useEffect } from "react";

gsap.registerPlugin(ScrollTrigger); // Register ScrollTrigger plugin

interface CircleProps {
	level: number;
}

const Circle: React.FC<CircleProps> = ({ level }) => {
	const pathRef = useRef<SVGCircleElement>(null);
	const mainRef = useRef<SVGSVGElement>(null);

	useGSAP(() => {
		const path = pathRef.current;
		const main = mainRef.current;

		const tl = gsap.timeline({
			scrollTrigger: {
				trigger: main,
				start: "top 30%",
				end: "top 20%",
				scrub: true,
				markers: true,
			},
		});

		tl.fromTo(
			path,
			{
				strokeDasharray: 2 * Math.PI * 40, // Circumference of the circle
				strokeDashoffset: 2 * Math.PI * 40, // Draw the whole circle initially
			},
			{
				strokeDashoffset: 2 * Math.PI * 40 - 10 * level), // Offset to 0 to reveal the circle
			},
	);
}, []);

return (
	<svg width="100" height="100" ref={mainRef}>
		<circle
			cx="50"
			cy="50"
			stroke="black"
			ref={pathRef}
			strokeWidth={4}
			r="40"
			fill="none"
		/>
	</svg>
);
};

export default Circle;
